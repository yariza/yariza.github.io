(window.webpackJsonp=window.webpackJsonp||[]).push([["clouds"],[,,,function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function e(n,t,o){null===n&&(n=Function.prototype);var r=Object.getOwnPropertyDescriptor(n,t);if(void 0===r){var a=Object.getPrototypeOf(n);return null===a?void 0:e(a,t,o)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(o):void 0},r=u(t(6)),a=u(t(7)),i=(t(0),u(t(8))),c=u(t(9));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function n(e){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.getName=function(){return"clouds"},t.supportsAudio=function(){return!1},t.setup=function(){t.time=0;var e=t.ctx.context;e.viewport(0,0,t.ctx.width,t.ctx.height);var n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,i.default),e.compileShader(n);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,c.default),e.compileShader(o),t.fs=o;var r=e.createProgram();e.attachShader(r,n),e.attachShader(r,o),e.linkProgram(r),t.program=r,e.getShaderParameter(n,e.COMPILE_STATUS)||(console.warn(i.default.split("\n").map(function(e,n){return("    "+n).slice(-4)+": "+e}).join("\n")),console.error(e.getShaderInfoLog(n))),e.getShaderParameter(o,e.COMPILE_STATUS)||(console.warn(c.default.split("\n").map(function(e,n){return("    "+n).slice(-4)+": "+e}).join("\n")),console.error(e.getShaderInfoLog(o))),e.getProgramParameter(r,e.LINK_STATUS)||console.error(e.getProgramInfoLog(r));var a=new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,a,e.STATIC_DRAW),e.useProgram(r),r.uColor=e.getUniformLocation(r,"_color"),e.uniform4fv(r.uColor,[0,.3,0,1]),r.uTime=e.getUniformLocation(r,"_time"),e.uniform1f(r.uTime,0),r.uResolution=e.getUniformLocation(r,"_resolution"),e.uniform2fv(r.uResolution,[t.ctx.width,t.ctx.height]),r.aVertexPosition=e.getAttribLocation(r,"position"),e.enableVertexAttribArray(r.aVertexPosition),e.vertexAttribPointer(r.aVertexPosition,2,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLES,0,6)},t.resize=function(){t.ctx.context.viewport(0,0,t.ctx.width,t.ctx.height)},t.mousemove=function(){},t.update=function(){t.time+=1/30},t.draw=function(){t.stats&&(t.stats.end(),t.stats.begin());var e=t.ctx.context;e.uniform1f(t.program.uTime,t.time),e.uniform2fv(t.program.uResolution,[t.ctx.width,t.ctx.height]),e.drawArrays(e.TRIANGLES,0,6),o(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"draw",t).call(t)},t.curDark=t.dark,t.ctx=r.default.create(Object.assign(e,{type:"webgl",retina:!1})),t.ctx.setup=t.setup.bind(t),t.ctx.resize=t.resize.bind(t),t.ctx.mousemove=t.mousemove.bind(t),t.ctx.update=t.update.bind(t),t.ctx.draw=t.draw.bind(t),t}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(n,a.default),n}();n.default=s},,,function(e,n,t){"use strict";var o,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(a,i){"object"===r(n)?e.exports=i(a,a.document):void 0===(o=function(){return i(a,a.document)}.call(n,t,n,e))||(e.exports=o)}("undefined"!=typeof window?window:void 0,function(e,n){var t="E LN10 LN2 LOG2E LOG10E PI SQRT1_2 SQRT2 abs acos asin atan ceil cos exp floor log round sin sqrt tan atan2 pow max min".split(" "),o=Math,r="canvas",a="dom",i=n,c=e,u=[],s={fullscreen:!0,autostart:!0,autoclear:!0,autopause:!0,container:i.body,interval:1,globals:!0,retina:!1,type:r},l={8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",27:"ESCAPE",32:"SPACE",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"};function f(e){return"function"==typeof e}function p(e){return"string"==typeof e}function m(e,n,t){for(var o in n)!t&&o in e||(e[o]=n[o]);return e}function d(e,n){return function(){e.apply(n,arguments)}}function v(e){var n,t,o,s,v,h,g,y,_,b,w,x,P,S,A,C,T,E=0,O=[],R=!1,L=!1,z=c.devicePixelRatio||1,I=e.type==a,F=e.type==r,N={x:0,y:0,ox:0,oy:0,dx:0,dy:0},j=[e.eventTarget||e.element,V,"mousedown","touchstart",V,"mousemove","touchmove",V,"mouseup","touchend",V,"click",V,"mouseout",V,"mouseover",i,function(n){x=n.keyCode,P="keyup"==n.type,M[x]=M[function(e){return l[e]||String.fromCharCode(e)}(x)]=!P,G(e[n.type],n)},"keydown","keyup",c,function(n){e.autopause&&("blur"==n.type?q:W)();G(e[n.type],n)},"focus","blur",U,"resize"],M={};for(x in l)M[l[x]]=!1;function G(n){f(n)&&n.apply(e,[].splice.call(arguments,1))}function B(e){for(h=0;h<j.length;h++)p(_=j[h])?o[(e?"add":"remove")+"EventListener"].call(o,_,t,{passive:!1,capture:!1}):f(_)?t=_:o=_}function U(){o=I?e.style:e.canvas,g=I?"px":"",C=e.width,T=e.height,e.fullscreen&&(T=e.height=c.innerHeight,C=e.width=c.innerWidth),e.retina&&F&&z&&(o.style.height=T+"px",o.style.width=C+"px",C*=z,T*=z),o.height!==T&&(o.height=T+g),o.width!==C&&(o.width=C+g),F&&!e.autoclear&&e.retina&&e.scale(z,z),L&&G(e.resize)}function Y(n,t){return function(e,n){v=n.getBoundingClientRect(),e.x=e.pageX-v.left-(c.scrollX||c.pageXOffset),e.y=e.pageY-v.top-(c.scrollY||c.pageYOffset)}(n,e.element),(t=t||{}).ox=t.x||n.x,t.oy=t.y||n.y,t.x=n.x,t.y=n.y,t.dx=t.x-t.ox,t.dy=t.y-t.oy,t}function H(n){if(n.currentTarget===e.element&&n.preventDefault(),(b=function(e){var n={};for(var t in e)"webkitMovementX"!==t&&"webkitMovementY"!==t&&(f(e[t])?n[t]=d(e[t],e):n[t]=e[t]);return n}(n)).originalEvent=n,b.touches)for(O.length=b.touches.length,h=0;h<b.touches.length;h++)O[h]=Y(b.touches[h],O[h]);else O.length=0,O[0]=Y(b,N);return m(N,O[0],!0),b}function V(n){for(n=H(n),S=(A=j.indexOf(w=n.type))-1,e.dragging=!!/down|start/.test(w)||!/up|end/.test(w)&&e.dragging;S;)p(j[S])?G(e[j[S--]],n):p(j[A])?G(e[j[A++]],n):S=0}function W(){e.now=+new Date,e.running=!0}function q(){e.running=!1}return m(e,{touches:O,mouse:N,keys:M,dragging:!1,running:!1,millis:0,now:NaN,dt:NaN,destroy:function(){s=e.element.parentNode,h=u.indexOf(e),s&&s.removeChild(e.element),~h&&u.splice(h,1),B(!1),q()},toggle:function(){(e.running?q:W)()},clear:function(){F&&e.clearRect(0,0,e.width*z,e.height*z)},start:W,stop:q}),u.push(e),e.autostart&&W(),B(!0),U(),function t(){D(n),n=k(t),L||(G(e.setup),L=f(e.setup)),R||(G(e.resize),R=f(e.resize)),e.running&&!E&&(e.dt=(y=+new Date)-e.now,e.millis+=e.dt,e.now=y,G(e.update),F&&(e.retina&&(e.save(),e.autoclear&&e.scale(z,z)),e.autoclear&&e.clear()),G(e.draw),F&&e.retina&&e.restore()),E=++E%e.interval}(),e}for(var h,g,y={CANVAS:r,WEB_GL:"webgl",WEBGL:"webgl",DOM:a,instances:u,install:function(e){if(!e.__hasSketch){for(var n=0;n<t.length;n++)e[t[n]]=o[t[n]];m(e,{TWO_PI:2*o.PI,HALF_PI:o.PI/2,QUARTER_PI:o.PI/4,random:function(e,n){return function(e){return"[object Array]"==Object.prototype.toString.call(e)}(e)?e[~~(o.random()*e.length)]:(function(e){return"number"==typeof e}(n)||(n=e||1,e=0),e+o.random()*(n-e))},lerp:function(e,n,t){return e+t*(n-e)},map:function(e,n,t,o,r){return(e-n)/(t-n)*(r-o)+o}}),e.__hasSketch=!0}},create:function(e){return(e=m(e||{},s)).globals&&y.install(self),h=e.element=e.element||i.createElement(e.type===a?"div":"canvas"),g=e.context=e.context||function(){switch(e.type){case r:return h.getContext("2d",e);case"webgl":return h.getContext("webgl",e)||h.getContext("experimental-webgl",e);case a:return h.canvas=h}}(),(e.container||i.body).appendChild(h),y.augment(g,e)},augment:function(e,n){return(n=m(n||{},s)).element=e.canvas||e,n.element.className+=" sketch",m(e,n,!0),v(e)}},_=["ms","moz","webkit","o"],b=self,w=0,x="AnimationFrame",P="request"+x,S="cancel"+x,k=b[P],D=b[S],A=0;A<_.length&&!k;A++)k=b[_[A]+"Request"+x],D=b[_[A]+"Cancel"+x];return b[P]=k=k||function(e){var n=+new Date,t=o.max(0,16-(n-w)),r=setTimeout(function(){e(n+t)},t);return w=n+t,r},b[S]=D=D||function(e){clearTimeout(e)},y})},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var r=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.darkBG="#0e0e0e".match(/[A-Za-z0-9]{2}/g).map(function(e){return parseInt(e,16)/255}),this.lightBG="#ffffff".match(/[A-Za-z0-9]{2}/g).map(function(e){return parseInt(e,16)/255}),this.dark="dark"===document.body.id?1:0,"undefined"!=typeof CCapture&&(this.ccapture=new CCapture({format:"png",framerate:30,verbose:!0}),this.numframes=300,this.ccapture.start())}return o(e,[{key:"getName",value:function(){return"untitled"}},{key:"supportsAudio",value:function(){return!1}},{key:"setDarkMode",value:function(e){this.dark=!0===e?1:0}},{key:"capture",value:function(e){}},{key:"draw",value:function(){this.ccapture&&(this.frames=this.frames||0,this.frames<this.numframes?this.ccapture.capture(this.ctx.element):this.frames===this.numframes&&(this.ccapture.stop(),this.ccapture.save()),this.frames++)}}]),e}();n.default=r},function(e,n){e.exports="#define GLSLIFY 1\nattribute vec2 position;\n\nvarying vec2 uv;\n\nvoid main() {\n    uv = position * 0.5 + 0.5;\n    gl_Position = vec4(position, 0.0, 1.0);\n}\n"},function(e,n){e.exports="precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 _color;\nuniform float _time;\nuniform vec2 _resolution;\n\nuniform float _noiseFreq;\n\nvarying vec2 uv;\n\n// #pragma glslify: fbm_9_2D = require(../../include/fbm/2D/fbm_9_2D)\nfloat hash1_1D_3_0( float n )\n{\n    return fract( n*17.0*fract( n*0.3183099 ) );\n}\n\n\n\n\nfloat noise_3D_2_1( in vec3 x )\n{\n    vec3 p = floor(x);\n    vec3 w = fract(x);\n    \n    vec3 u = w*w*w*(w*(w*6.0-15.0)+10.0);\n    \n    float n = p.x + 317.0*p.y + 157.0*p.z;\n    \n    float a = hash1_1D_3_0(n+0.0);\n    float b = hash1_1D_3_0(n+1.0);\n    float c = hash1_1D_3_0(n+317.0);\n    float d = hash1_1D_3_0(n+318.0);\n    float e = hash1_1D_3_0(n+157.0);\n\tfloat f = hash1_1D_3_0(n+158.0);\n    float g = hash1_1D_3_0(n+474.0);\n    float h = hash1_1D_3_0(n+475.0);\n\n    float k0 =   a;\n    float k1 =   b - a;\n    float k2 =   c - a;\n    float k3 =   e - a;\n    float k4 =   a - b - c + d;\n    float k5 =   a - c - e + g;\n    float k6 =   a - b - e + f;\n    float k7 = - a + b + c - d + e - f - g + h;\n\n    return -1.0+2.0*(k0 + k1*u.x + k2*u.y + k3*u.z + k4*u.x*u.y + k5*u.y*u.z + k6*u.z*u.x + k7*u.x*u.y*u.z);\n}\n\n\n\n\nconst mat3 m3_1_2  = mat3( 0.00,  0.80,  0.60,\n                      -0.80,  0.36, -0.48,\n                      -0.60, -0.48,  0.64 );\n\nfloat fbm_4_3D_1_3( in vec3 x )\n{\n    float f = 2.0;\n    float s = 0.5;\n    float a = 0.0;\n    float b = 0.5;\n\n    // #pragma unroll_loop\n    for( int i=0; i<5; i++ )\n    {\n        float n = noise_3D_2_1(x);\n        a += b*n;\n        b *= s;\n        x = f*m3_1_2*x;\n    }\n\treturn a;\n}\n\n\n\n\n\nmat3 setCamera( vec3 ro, vec3 ta, float cr )\n{\n\tvec3 cw = normalize(ta-ro);\n\tvec3 cp = vec3(sin(cr), cos(cr),0.0);\n\tvec3 cu = normalize( cross(cw,cp) );\n\tvec3 cv = normalize( cross(cu,cw) );\n    return mat3( cu, cv, cw );\n}\n\nfloat rayPlaneIntersection( vec3 ro, vec3 rd, vec3 po, vec3 pn)\n{\n    float denom = dot(pn, rd);\n    float t = dot(po - ro, pn) / denom;\n    return t;\n}\n\nfloat fbm_2(vec3 pos)\n{\n    float value = 0.0;\n    float intensity = 0.5;\n    for (int i = 0; i < 2; i++)\n    {\n        value += noise_3D_2_1(pos) * intensity;\n        intensity *= 0.5;\n        pos *= 2.0;\n    }\n    return value;\n}\n\nfloat map(vec3 pos)\n{\n    float density = clamp(fbm_2(pos * 0.007 + vec3(0.3, 0.0, 2.0) * _time), 0.0, 1.0);\n    density -= smoothstep(-200.0, 10.0, pos.y);\n    density *= smoothstep(-700.0, -500.0, pos.y);\n    density -= 0.1;\n    return clamp(density, 0.0, 1.0);\n}\n\nfloat shadow(vec3 pos)\n{\n    float s = 0.0;\n    vec3 lightDir = normalize(vec3(0.0, 3.0, 0.0));\n    s += map(pos + 1.0 * lightDir);\n    s += map(pos + 10.3 * lightDir);\n    s += map(pos + 20.3 * lightDir);\n    s += map(pos + 30.4 * lightDir);\n    s += map(pos + 40.8 * lightDir);\n    s *= 0.2;\n    return s;\n}\n\nvec4 raymarch(vec3 cameraPos, vec3 rayDir, float stepSize, out int steps, out vec3 endPos)\n{\n    vec4 sum = vec4(0.0, 0.0, 0.0, 1.0);\n    vec3 pos = cameraPos;\n    float weight = stepSize;\n    steps = 0;\n    for (int i = 0; i < 128; i++)\n    {\n        float s = shadow(pos);\n        vec3 color = mix(vec3(0.8, 0.8, 0.8), vec3(0.1, 0.1, 0.02), s);\n        // vec3 color = vec3(0.5, 0.2, 0.2);\n        float alpha = map(pos);\n        sum.rgb += sum.a * alpha * color;\n        sum.a *= (1.0 - alpha);\n        if (sum.a < 0.01) break;\n        pos += rayDir * stepSize;\n        stepSize *= 1.013;\n        steps++;\n    }\n    endPos = pos;\n    return clamp(sum, 0.0, 1.0);\n}\n\nvoid main()\n{\n    float aspectRatio = _resolution.x / _resolution.y;\n    vec2 p = (uv - 0.5) * vec2(aspectRatio, 1.0);\n\n    // gl_FragColor = vec4(fract(p * 10.0), 0.0, 1.0);\n    // return;\n    \n    vec3 cameraPos = vec3(0.0, 10.0, -80.0);\n    vec3 cameraTarget = vec3(0.0, 0.0, 0.0);\n\n    mat3 cameraMat = setCamera(cameraPos, cameraTarget, 0.0);\n    vec3 rayDir = cameraMat * normalize(vec3(p.xy, 1.0));\n\n    vec3 planeNormal = vec3(0.0, 1.0, 0.0);\n    vec3 planeCenter = vec3(0.0, 9.0, 0.0);\n\n    float t = rayPlaneIntersection(cameraPos, rayDir, planeCenter, planeNormal);\n\n    vec3 startPos = cameraPos;   \n    if (t > 0.0) {\n        startPos += rayDir * t;\n        int steps;\n        vec3 endPos;\n        vec4 color = raymarch(startPos, rayDir, 10.0, steps, endPos);\n        gl_FragColor = vec4(vec3(0.3, 0.3, 0.5) * color.a + color.rgb, 1.0);\n        // float dist = length(endPos - cameraPos);\n        // gl_FragColor = mix(\n        //     vec4(0.3, 0.3, 0.5, 1.0),\n        //     mix(\n        //         vec4(0.8, 0.8, 0.8, 1.0),\n        //         vec4(0.7, 0.5, 0.5, 1.0),\n        //         clamp(pow(dist / 4000.0, 0.6), 0.0, 1.0)\n        //     ),\n        //     alpha\n        // );\n        // gl_FragColor = mix(vec4(0.0, 0.8, 0.8, 1.0), vec4(1.0, 0.0, 0.0, 1.0), float(steps) / 128.0);\n        // gl_FragColor = mix(vec4(0.3, 0.3, 0.5, 1.0), vec4(0.8, 0.8, 0.8, 1.0), alpha);\n        return;\n    }\n    else {\n        gl_FragColor = vec4(0.3, 0.3, 0.5, 1.0);\n        return;\n    }\n}\n"}]]);
//# sourceMappingURL=clouds.bundle.js.map